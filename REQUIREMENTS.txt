
________________________________________
要求仕様書：AIなぞかけ生成アプリ
1. 概要
本アプリは、ユーザーが入力した「お題A」に対して、OpenAI APIを用いて「AとかけてBととく。その心はCです。」という形式の日本語なぞかけを生成する。生成過程では語群抽出ステップ（P, Q, R）を経て、最終的にBとCを決定する。生成結果はSupabaseに保存され、後の解析に活用される。
________________________________________
2. 開発・運用環境
項目	内容
バージョン管理	GitHub
デプロイ環境	Vercel
開発支援	GitHub Copilot（今後活用）
バックエンド	Next.js API Routes
外部API	OpenAI GPT API
データベース	Supabase（PostgreSQL）
フロントエンド	React + Tailwind CSS（想定）
スプレッドシート連携	Google Sheets API（プロンプトプリセット管理）
________________________________________
3. 機能要件
3.1 ユーザー入力
•	お題A（日本語の単語または短文）を入力
•	プロンプトプリセットを選択（Google Spreadsheet上で管理）
3.2 なぞかけ生成
•	OpenAI APIに対して以下の構造のプロンプトを送信：
{
  "instruction": "...",
  "topic": "A",
  "steps": [
    { "name": "P", "count": "L", "description": "..." },
    { "name": "Q", "count": "M", "description": "..." },
    { "name": "R", "count": "N", "description": "..." }
  ],
  "constraints": [...],
  "output_format": "AとかけてBととく。その心はCです。"
}
•	L, M, N は 1〜3 の整数で、語群抽出の数を制御
•	OpenAIは語群 (P, Q, R) を抽出し、BとCを決定
3.3 結果表示
•	なぞかけ文を画面に表示
•	必要に応じて語群構造 (P, Q, R) を展開表示
3.4 ログ保存（Supabase）
•	以下の情報を Supabase に保存：
項目	内容
topic	お題A
prompt_set_id	使用したプリセットID
L, M, N	各ステップの語群数
output_text	なぞかけ文
related_terms	(P, Q, R) の語群構造（JSON形式）
created_at	生成日時
________________________________________
4. 非機能要件
•	再現性：プロンプト構造と語群抽出ステップが明示されており、生成過程が再現可能
•	拡張性：Google Spreadsheetでプロンプトプリセットを管理し、柔軟に切り替え可能
•	透明性：語群構造と制約条件が明示され、解析に適したログ設計
•	教育性：ステップ構造が明示されており、語彙連想の学習にも活用可能
________________________________________
5. 今後の開発方針
•	GitHub Copilot を活用し、プロンプト構築・API連携・UI改善を効率化
•	Google Sheets API を導入し、プリセット選択を動的に切り替え可能にする
•	Supabaseのログを分析し、人気語群や生成傾向を可視化する機能を追加予定
________________________________________

